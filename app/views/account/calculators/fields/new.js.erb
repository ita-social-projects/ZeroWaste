// Render HTML for one field on backend
const newFieldForm = document.createElement("div");
newFieldForm.innerHTML = `<%= escape_javascript(render 'account/calculators/fields/new', calculator: @calculator) %>`;

// Extract new selector data
const fieldsContainer = document.querySelector(`[data-kind="${@field.kind}"]`);
const selectorLetter = fieldsContainer.getAttribute('data-selector-letter');
const selectorNumber = (parseInt(fieldsContainer.getAttribute('data-last-selector')) || 0) + 1;
// Hide 'No fields yet' text
const emptyTextElements = fieldsContainer.querySelectorAll("[data-empty-text]");
emptyTextElements.forEach(function(element) {
  element.remove();
});
// Increment current selector on fields group by 1
fieldsContainer.setAttribute("data-last-selector", selectorNumber);
// Set selector in HTML for new field
const selectorInput = newFieldForm.querySelector("[data-selector-input]");
selectorInput.value = `${selectorLetter}${selectorNumber}`;
const selector = newFieldForm.querySelector("[data-selector]");
selector.innerHTML = `${selectorLetter}${selectorNumber}`;

// Append field to the group of fields
const nestedFields = newFieldForm.querySelector(".nested-fields");
fieldsContainer.appendChild(nestedFields);